This guide is an extended version of the Embedded onramp quickstart. Learn how to add more functionality such as:
Installing the SDK using a script tag or package manager
Fetching estimated quotes for onramp conversions into cryptocurrencies
Configuring the onramp UI into mobile web views

CLIENT-SIDE
Include the following scripts using script tags within the  element of your HTML. These scripts must always load directly from Stripe’s domains (https://js.stripe.com and  https://crypto-js.stripe.com) for compatibility and PCI compliance. Don’t include the scripts in a bundle or host a copy yourself. If you do, your integration might break without warning.

```html
<head>
  <title>Onramp</title>
  <script src="https://js.stripe.com/clover/stripe.js"></script>
  <script src="https://crypto-js.stripe.com/crypto-onramp-outer.js"></script>
</head>

```

USE THE ONRAMP JS SDK AS A MODULE
Use the npm package to load the onramp JS SDK as an ES module. The package includes Typescript type definitions.

```
npm install --save @stripe/stripe-js @stripe/crypto

```
Alternatively, you can install the Stripe Crypto ES module client-side SDK using a script tag or package manager. The SDK wraps the global  function provided by the Stripe crypto script as an ES module.
Manually load the script. Include the following scripts using script tags within the  element of your HTML. These scripts must always load directly from Stripe’s domains, https://js.stripe.com and https://crypto-js.stripe.com, for compatibility and PCI compliance. Don’t include the scripts in a bundle or host a copy yourself. If you do, your integration might break without warning.

```html
<head>
  <title>Onramp</title>
  <script src="https://js.stripe.com/clover/stripe.js"></script>
  <script src="https://crypto-js.stripe.com/crypto-onramp-outer.js"></script>
</head>

```
Set the API publishable key to allow Stripe to retrieve the  object created by your back end. For example:

```javascript
const stripeOnramp = StripeOnramp('');

```
To install the module through the package manager, first install the Stripe.js ES module and Stripe crypto ES module from the npm public registry. The package includes Typescript type definitions.

```bash
npm install @stripe/stripe-js @stripe/crypto

```
Import the module and set the API publishable key to allow Stripe to retrieve the  object created by your back end. The function returns a  object that resolves with a newly created  object after the scripts load.

```javascript
import {loadStripeOnramp} from '@stripe/crypto';

const stripeOnramp = await loadStripeOnramp('');

```

SERVER-SIDE
Our official libraries don’t contain built-in support for the API endpoints because the onramp API is in limited beta. As a result, our examples use curl for backend interactions.
Generate a crypto onramp session by running the following curl command in your terminal:

```bash
curl -X POST https://api.stripe.com/v1/crypto/onramp_sessions \
  -u : \
  -d "wallet_addresses[ethereum]"="0xB00F0759DbeeF5E543Cc3E3B07A6442F5f3928a2"
  # add as many parameters as you'd like

```
You receive a response similar to the following:

```json
{
  "id": "cos_0MYfrA589O8KAxCGEDdIVYy3",
  "object": "crypto.onramp_session",
  "client_secret": "cos_0MYfrA589O8KAxCGEDdIVYy3_secret_rnpnWaxQbYQOvp6nVMvEeczx300NRU4hErZ",
  "created": 1675732824,
  "livemode": false,
  "status": "initialized",
  "transaction_details": {
    "destination_currency": null,
    "destination_amount": null,
    "destination_network": null,
    "fees": null,
    "lock_wallet_address": false,
    "source_currency": null,
    "source_amount": null,
    "destination_currencies": [
      "btc",
      "eth",
      "sol",
      "usdc"
    ],
    "destination_networks": [
      "bitcoin",
      "ethereum",
      "solana"
    ],
    "transaction_id": null,
    "wallet_address": null,
    "wallet_addresses": {
      "bitcoin": null,
      "ethereum": "0xB00F0759DbeeF5E543Cc3E3B07A6442F5f3928a2",
      "polygon": null,
      "solana": null
    }
  }
}

```
See the Onramp API reference for the full parameter list you can pass in when creating a session.
After running the script, the onramp renders the following dialog:
Stripe’s fiat-to-crypto onramp embedded within a third-party application

SANDBOX VALUES
Sandbox transaction amounts are overridden by our pre-decided limits.
Use the following values to complete an onramp transaction in sandbox:
On the OTP screen, use  for the verification code.
On the personal information screen, use  for the SSN and  for address line 1.
On the payment details screen, use the test credit card number .
After you’ve launched the onramp, you can view customized usage reports in the Stripe Dashboard. You can also return to the onboarding page to update the domains where you plan to host the onramp, and check the status of any onboarding tasks.
Integrate Stripe’s crypto onramp UI into mobile web views and browsers by minting a session, hosting the onramp UI, completing the purchase, and redirecting users back to the mobile app.

MINT A SESSION
Similar to other integrations, you need to implement a server endpoint to create a new onramp session for every user visit. The endpoint returns a  that can load the onramp UI or display an error if the onramp is unavailable.

HOST THE ONRAMP UI
Create a frontend route (for example, www.my-web3-wallet.com/onramp/<client_secret>) to host the onramp UI. Your /onramp/<client_secret> points to an onramp.html.

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Crypto Onramp</title>
    <meta name="description" content="A demo of the hosted onramp" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script type="text/javascript" src="https://crypto-js.stripe.com/crypto-onramp-outer.js"></script>
    <script src="onramp.js" defer></script>
  </head>
  <body>
    <div id="onramp-element" />
  </body>
</html>

```
Where onramp.js consumes the  from the URL and mounts the onramp UI:

```js
const stripeOnramp = StripeOnramp();
initialize();
// initialize onramp element with client secret
function initialize() {
  const url = window.location.href.replace(/\/$/, '');
  const clientSecret = url.substring(url.lastIndexOf('/') + 1);
  const onrampSession = stripeOnramp.createSession({
    clientSecret,
    // other client side options that customize the look and feel
  });
  onrampSession
    .addEventListener('onramp_session_updated', handleSessionUpdate)
    .mount("#onramp-element");
}
function handleSessionUpdate(event) {
  const session = event.payload.session;
  if (session.status === 'fulfillment_complete' || session.status === 'rejected') {
    // redirect back to mobile app through universal link
    window.location.assign('/onramp_success/' + session.id);
  }
}

```
Configure universal links to deep link  back to your mobile app. Consider providing a fallback or  page to prompt users to manually switch back to your app.

COMPLETE THE PURCHASE
As with a standard integration, the front-end client controls the entire onramp UI. The UI adapts to fit the screen size. As the session state changes and we gather more , the  object updates accordingly. We generate webhooks and front-end events for every status transition. By using front-end event listeners, you can redirect users back to your application flow when the  completes.

REDIRECT TO THE MOBILE APP
Using a deep link or manual switch, users can resume their flow in your mobile application. Your mobile application can use your back end to continue querying the  state.
For example, if a user is topping up their balance during initial setup, you can redirect them back to your application as soon as the session transitions to . You can allow users to explore the rest of your application while polling the  status in the background.
The Onramp Quotes API lets you fetch estimated quotes for onramp conversions into various cryptocurrencies on different networks. You can specify a fixed source or destination amount and limit the quotes to a subset of destination currencies or networks. This API allows you to display quotes in your product UI before directing the user to the onramp widget. If the quote expires before the user visits the onramp widget, the user might see a slightly different quote in the onramp widget.

GET A CONVERSION QUOTE
Use the  endpoint to get a conversion quote. The following table captures all of the available parameters for this endpoint:
ParameterTypeDefaultDetailsString (optional)The ISO-4217 currency code. We currently only support  and .String (optional)A string representation of the fiat amount that you need to onramp. If  is set,  must be null (they’re mutually exclusive, because you can only set a fixed amount for one end of the trade).String (optional)A string representation of the amount of  to be purchased. If  is set,  must be null. When specifying this field, you must also set a single value for  and a single value for  (so we know what cryptocurrency to quote).Array<String> (optional)
The list of cryptocurrencies you want to generate quotes for. If left , we retrieve quotes for all  that  supports.Currencies: , , , , ,
Array<String> (optional)
The list of cryptocurrency networks you want to generate quotes for. If left , we retrieve quotes for  in all networks.Networks: , , ,  ,

EXAMPLE QUOTE REQUESTS
To fetch all destination currency-network pairs with a default source amount of 100 USD, run the following command:

```bash
curl -G https://api.stripe.com/v1/crypto/onramp/quotes \
  -u :

```
You receive a response similar to the following:

```json
{
  "id": "cd35838481497f403988360cc0ff5ce5c5ce7451ce8938f86d379dff7157d33d",
  "rate_fetched_at": 1674265380.6883376,
  "destination_network_quotes": {
    "ethereum": [
      {
        "id": "7eb9ccb7c1bffadf3773ca1f56ba3a352fe4a226328e72142925a80e7242b70c",
        "destination_currency": "eth",
        "destination_amount": "0.060232255577506866",
        "destination_network": "ethereum",
        "fees": {
          "network_fee_monetary": "1.41",
          "transaction_fee_monetary": "3.03"
        },
        "source_total_amount": "104.44"
      },
      {
        "id": "398de047128b6dff1abbc41519811db68dd8bcb69939b87c4a4621b1740a1c5b",
        "destination_currency": "usdc",
        "destination_amount": "100.00",
        "destination_network": "ethereum",
        "fees": {
          "network_fee_monetary": "5.63",
          "transaction_fee_monetary": "3.07"
        },
        "source_total_amount": "108.70"
      }
    ],
    ...
  },
  "livemode": true,
  "source_currency": "usd",
  "source_amount": "100.00"
}

```
To fetch all destination currency-network pairs with a source amount of 200 USD, run the following command:

```bash
  curl -G https://api.stripe.com/v1/crypto/onramp/quotes \
    -u : \
    -d "source_amount"="200"

```
You receive a response similar to the following:

```json
{
  "id": "2e5818944df6a2325c7e9c1e72d27174b9bedfc8e64ace47c081370a5b982a7b",
  "rate_fetched_at": 1674265506.3408287,
  "destination_network_quotes": {
    "ethereum": [
      {
        "id": "d160a80828eabb6b6d4aeafac585eee62d95425c7fb7577866ab04b9a786df00",
        "destination_currency": "eth",
        "destination_amount": "0.253568242640499553",
        "destination_network": "ethereum",
        "fees": {
          "network_fee_monetary": "1.45",
          "transaction_fee_monetary": "12.71"
        },
        "source_total_amount": "214.20"
      },
      {
        "id": "53f864cb28a42f11e1d9d5aff7e43ac96b056406f74cbf618399c6fa40f3d275",
        "destination_currency": "usdc",
        "destination_amount": "200.00",
        "destination_network": "ethereum",
        "fees": {
          "network_fee_monetary": "5.80",
          "transaction_fee_monetary": "12.76"
        },
        "source_total_amount": "218.56"
      }
    ],
    ...
  },
  "livemode": true,
  "source_currency": "usd",
  "source_amount": "200.00"
}

```
To fetch quotes for ETH and SOL on the Ethereum and Solana networks, run the following command (which results in ETH on Ethereum and SOL on Solana). When you specify  and , each valid currency-network pair in their cross-product returns a quote. The default value for  is all currencies, and the default value for  is all networks.

```bash
    curl -G https://api.stripe.com/v1/crypto/onramp/quotes \
      -u : \
      -d "source_amount"="200" \
      -d "destination_currencies[]"="eth" \
      -d "destination_currencies[]"="sol" \
      -d "destination_networks[]"="ethereum" \
      -d "destination_networks[]"="solana"

```
You receive a response similar to the following:

```json
{
  "id": "c9ab6fd14f87290ef94b583f0dd346de8e197321e029776c12b7790cd83fb78c",
  "rate_fetched_at": 1674265576.8238478,
  "destination_network_quotes": {
    "bitcoin": [],
    "ethereum": [
      {
        "id": "97bbd7b9f8bc1a029264cdc28b47b636e989f8bcab96a80a3bded2094131e311",
        "destination_currency": "eth",
        "destination_amount": "0.253433817682353791",
        "destination_network": "ethereum",
        "fees": {
          "network_fee_monetary": "1.46",
          "transaction_fee_monetary": "12.71"
        },
        "source_total_amount": "214.17"
      }
    ],
    "polygon": [],
    "solana": [
      {
        "id": "79f00923b96543aa69d140172c7cefd0e73a2ed089d8935e63dcf21028698e23",
        "destination_currency": "sol",
        "destination_amount": "16.767237943",
        "destination_network": "solana",
        "fees": {
          "network_fee_monetary": "0.01",
          "transaction_fee_monetary": "12.70"
        },
        "source_total_amount": "212.71"
      }
    ]
  },
  "livemode": true,
  "source_currency": "usd",
  "source_amount": "200.00"
}

```
To fetch quotes for USDC on Ethereum and Solana, run the following command:

```bash
curl -G https://api.stripe.com/v1/crypto/onramp/quotes \
  -u : \
  -d "source_amount"="200" \
  -d "destination_currencies[]"="usdc" \
  -d "destination_networks[]"="ethereum" \
  -d "destination_networks[]"="solana"

```
You receive a response similar to the following:

```json
{
  "id": "8727e8de9a22915aea079973028054e31d362a328758a5953cee6ba1b6f22569",
  "rate_fetched_at": 1674268717.432479,
  "destination_network_quotes": {
    "bitcoin": [],
    "ethereum": [
      {
        "id": "603f29933c921d59b169572cf2d61da7d88f2a6973da0d6fcb686b3dec3de223",
        "destination_currency": "usdc",
        "destination_amount": "200.00",
        "destination_network": "ethereum",
        "fees": {
          "network_fee_monetary": "5.88",
          "transaction_fee_monetary": "12.76"
        },
        "source_total_amount": "218.64"
      }
    ],
    "polygon": [],
    "solana": [
      {
        "id": "38b8388072e6272e7a0c0d5ee1161d3d747362a574f54fe76f1554ff60e3a007",
        "destination_currency": "usdc",
        "destination_amount": "200.00",
        "destination_network": "solana",
        "fees": {
          "network_fee_monetary": "0.01",
          "transaction_fee_monetary": "12.70"
        },
        "source_total_amount": "212.71"
      }
    ]
  },
  "livemode": true,
  "source_currency": "usd",
  "source_amount": "200.00"
}

```
To fetch a quote for a single destination currency-network pair (ETH on Ethereum) with  specified, run the following command:

```bash
curl -G https://api.stripe.com/v1/crypto/onramp/quotes \
  -u : \
  -d "destination_amount"="0.42" \
  -d "destination_currencies[]"="eth" \
  -d "destination_networks[]"="ethereum"

```
You receive a response similar to the following:

```json
{
  "id": "74f73859a8836293ce4f1e6757dc258c9f1016deea7b075faba8b5755d163168",
  "rate_fetched_at": 1674268804.6989243,
  "destination_network_quotes": {
    "bitcoin": null,
    "ethereum": [
      {
        "id": "f1adad5680b081031b03b89c174d25ce6b609416fc82f976423e95a089a10334",
        "destination_currency": "eth",
        "destination_amount": "0.420000000000000000",
        "destination_network": "ethereum",
        "fees": {
          "network_fee_monetary": "1.45",
          "transaction_fee_monetary": "21.06"
        },
        "source_total_amount": "719.53"
      }
    ],
    "polygon": null,
    "solana": null
  },
  "livemode": true,
  "source_currency": "usd",
  "source_amount": "697.02"
}

```
